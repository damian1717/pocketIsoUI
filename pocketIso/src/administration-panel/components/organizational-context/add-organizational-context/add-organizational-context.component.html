<div class="main-content">
  <p class="header-name">Kontekst Organizacji</p>

  <form [formGroup]="organizationalContextForm" fxLayout="column" (ngSubmit)="onSubmit()">

    <div fxLayout="column">

      <div fxLayout="row wrap" fxLayoutAlign="start start" fxLayoutGap="20px">

        <input hidden matInput id="id" type="text" formControlName="id">

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="1" fxFlexOrder.sm="1"
          fxFlexOrder.xs="1">
          <mat-form-field appearance="fill" tabindex="1">
            <mat-label for="industry">Branża</mat-label>
            <input matInput id="industry" type="text" formControlName="industry">
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="2" fxFlexOrder.sm="2"
          fxFlexOrder.xs="2">
          <mat-form-field appearance="fill" tabindex="2">
            <mat-label for="factorsTechnologicalEnvironment">Czynniki z otoczenia prawnego, technologicznego,
              konkurencyjnego, rynkowego, kulturowego, społecznego, ekonomicznego, międzynarodowego, krajowego,
              regionalnego, lokalnego</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="factorsTechnologicalEnvironment" type="text"
              formControlName="factorsTechnologicalEnvironment"></textarea>
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="3" fxFlexOrder.sm="3"
          fxFlexOrder.xs="3">
          <mat-form-field appearance="fill" tabindex="3">
            <mat-label for="factorsRelatedToValuesCulture">Czynniki związane z wartościami, kulturą, wiedzą i działaniem
              organizacji</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="factorsRelatedToValuesCulture" type="text"
              formControlName="factorsRelatedToValuesCulture"></textarea>
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="4" fxFlexOrder.sm="4"
          fxFlexOrder.xs="4">
          <mat-form-field appearance="fill" tabindex="4">
            <mat-label for="externalAndInternalEntities">Wszystkie podmioty zewnętrzne i wewnętrzne, które wpływają lub
              mogą potencjalnie wpływać na zdolność organizacji do dostarczania produktów i usług, które spełniają
              wymagania klientów oraz obowiązujące przepisy prawne</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="externalAndInternalEntities" type="text"
              formControlName="externalAndInternalEntities"></textarea>
          </mat-form-field>
        </div>
      </div>

      <div fxLayout="row wrap" fxLayoutAlign="start start" fxLayoutGap="20px">

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="1" fxFlexOrder.sm="1"
          fxFlexOrder.xs="1">
          <mat-form-field appearance="fill" tabindex="5">
            <mat-label for="strengths">Silne strony</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="strengths" type="text" formControlName="strengths"></textarea>
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="2" fxFlexOrder.sm="2"
          fxFlexOrder.xs="2">
          <mat-form-field appearance="fill" tabindex="6">
            <mat-label for="weaknesses">Słabe strony</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="weaknesses" type="text" formControlName="weaknesses"></textarea>
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="3" fxFlexOrder.sm="3"
          fxFlexOrder.xs="3">
          <mat-form-field appearance="fill" tabindex="7">
            <mat-label for="chances">Szanse</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="chances" type="text" formControlName="chances"></textarea>
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="4" fxFlexOrder.sm="4"
          fxFlexOrder.xs="4">
          <mat-form-field appearance="fill" tabindex="8">
            <mat-label for="threats">Zagrożenia</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="threats" type="text" formControlName="threats"></textarea>
          </mat-form-field>
        </div>

      </div>

      <div fxLayout="row wrap" fxLayoutAlign="start start" fxLayoutGap="20px">
        <mat-radio-group aria-labelledby="example-radio-group-label" class="example-radio-group" formControlName="norm"
          (change)="handleRadiButtonChange($event)">
          @for (norm of norms; track norm) {
          <mat-radio-button class="example-radio-button" [value]="norm.id">{{norm.name}}</mat-radio-button>
          }
        </mat-radio-group>
      </div>

      <div *ngIf="showAdditionalNormFields" fxLayout="row wrap" fxLayoutAlign="start start" fxLayoutGap="20px">

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="1" fxFlexOrder.sm="1"
          fxFlexOrder.xs="1">
          <mat-form-field appearance="fill" tabindex="9">
            <mat-label for="numberNorm">Numer punktu z normy ISO</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="numberNorm" type="text" formControlName="numberNorm"></textarea>
          </mat-form-field>
        </div>

        <div fxLayout="column" fxFlex.gt-sm="20%" fxFlex.sm="50%" fxFlex.xs="100%" fxFlexOrder="2" fxFlexOrder.sm="2"
          fxFlexOrder.xs="2">
          <mat-form-field appearance="fill" tabindex="10">
            <mat-label for="normJustification">Uzasadnienie nie stosowania punktu</mat-label>
            <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5"
              cdkAutosizeMaxRows="50" id="normJustification" type="text" formControlName="normJustification"></textarea>
          </mat-form-field>
        </div>

      </div>

      <div fxLayout="row" fxLayoutAlign="center center">
        <button mat-raised-button color="primary" style="margin-right: 20px;" type="submit">Zapisz</button>
        <button mat-raised-button color="primary" type="button" (click)="generateReport()">Utwórz Raport</button>
      </div>

    </div>

  </form>
</div>

<div *ngIf="documents && documents.length > 0" style="margin: auto; width: 50%; padding-top: 70px;">
  <p>Lista utworzonych dokumentów:</p>
  <mat-list>
      <mat-list-item *ngFor="let document of documents">
          <div matListItemTitle style="padding-right: 20px;">{{document.name}}</div>
          <mat-icon matListItemIcon (click)="downloadDocumnet(document.id)">download</mat-icon>
      </mat-list-item>
  </mat-list>
</div>